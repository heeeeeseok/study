# 영속성이란?
> 데이터를 생성한 프로그램이 종료되어도 사라지지 않는 데이터의 특성을 말한다.

> 영속성을 갖지 않으면 데이터는 메모리에서만 존재하게 되고 프로그램이 종료되면 해당 데이터는 모두 사라지게 된다.

> 그래서 우리는 데이터를 파일이나 DB에 영구 저장함으로써 데이터에 영속성을 부여한다.

# EntitiyManagerFactory와 EntitiyManager
> EntitiyManagerFactory는 전체 애플리케이션에서 하나만 생성하여 공유하도록 설계됨. 따라서 여러 스레드가 동시에 접근해도 안전함

> EntityManager는 EntitiyManagerFactory로 부터 생성되고 생성 비용이 적다. 스레드간 공유하면 동시성 문제가 발생함.

# 영속성 컨텍스트
> 엔티티 매니저로 엔티티를 저장, 조회하면 영속성 컨텍스트에 보관, 관리

> 보통 트랜잭션을 commit하는 시점에 영속성 컨텍스트에 새로 저장된 엔티티를 DB에 반영 : flush

> 쓰기 지연을 지원하며, EntitiyManger는 트랜잭션을 시작할 때 커넥션을 획득하고, 항상 트랜잭션 안에서만 데이터를 변경해야함

> 변경감지(Dirty check) : 최초의 엔티티 객체 저장시 최초 상태를 영속성 컨텍스트의 스냅샷에 저장하고 flush시 스냅샷과 엔티티를 비교하고 다르다면 update쿼리를 생성
